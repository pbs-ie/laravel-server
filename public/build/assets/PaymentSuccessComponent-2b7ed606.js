import{r as S,a,j as C,F as j,d as v}from"./app-8ad4302f.js";import{u as w,P as B}from"./WrapperLayout-9c24c2d1.js";import{L as _}from"./Loader-f2cca895.js";import{S as F}from"./SecondaryButton-acbdc118.js";import{C as I}from"./CheckBadge-df0dd088.js";function z({cart:O,onClick:N,setErrorMessage:$,setSuccess:T,cartDescription:x=""}){const[l,n]=S.useState(""),d=()=>{n("")},E=async()=>{var r;d();try{let t={cart:O,description:x};const s=await(await fetch(route("paypal.create"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).json();if(s.id)return console.log("Order ID",s.id),s.id;{const o=(r=s==null?void 0:s.details)==null?void 0:r[0],u=o?`${o.issue} ${o.description} (${s.debug_id})`:JSON.stringify(s);throw new Error(u)}}catch(t){console.log(t),n("Could not initiate PayPal Checkout... Please try again later")}},b=async(r,t)=>{var i,s,o,u,h,f,m,y,g;d();try{const e=await(await fetch(route("paypal.capture",r.orderID),{method:"POST"})).json();console.log("Capture Order",e);const c=(i=e==null?void 0:e.details)==null?void 0:i[0];if((c==null?void 0:c.issue)==="INSTRUMENT_DECLINED")return t.restart();if(c)throw new Error(`${c.description} (${e.debug_id})`);if(e.purchase_units){const p=((h=(u=(o=(s=e==null?void 0:e.purchase_units)==null?void 0:s[0])==null?void 0:o.payments)==null?void 0:u.captures)==null?void 0:h[0])||((g=(y=(m=(f=e==null?void 0:e.purchase_units)==null?void 0:f[0])==null?void 0:m.payments)==null?void 0:y.authorizations)==null?void 0:g[0]);n(`Transaction ${p.status}: ${p.id}`),console.log(`Transaction ${p.status}: ${p.id} - See console for all available details`),T(!0),console.log("Capture result",e,JSON.stringify(e,null,2))}else throw new Error(JSON.stringify(e))}catch(P){console.log(`Transaction Failed: ${P.message}`),n("Transaction Failed. Please try again later.")}};return S.useEffect(()=>(l&&l!==""&&$(l),()=>{n("")}),[l]),a("div",{className:"w-full mx-auto",children:a(({showSpinner:r})=>{const[{isPending:t}]=w(),[{options:i},s]=w();return C(j,{children:[r&&t&&a(_,{}),!(r&&t)&&a(B,{style:{layout:"vertical",height:50,shape:"pill"},disabled:!1,createOrder:E,onApprove:b,onClick:N,onCancel:()=>{d(),s({type:"resetOptions",value:{...i}}),n("Order cancelled")}})]})},{showSpinner:!1})})}function A(){return C("div",{className:"flex flex-col items-center gap-4 my-6",children:[a(I,{className:"w-40 h-40 text-green-600"}),a("p",{children:"Your transaction has been successful!"}),a(v,{href:route("home"),children:a(F,{children:"Return Home"})})]})}export{z as P,A as a};
